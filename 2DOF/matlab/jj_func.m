%% Jacobian

function J=jj_func(X)

global L_hw L_ht L_hs L_rw L_rt L_rs L_rtw L_rts
global l_w l_t l_s q_s q_rh q_rk q_hh q_hk
global m_hw m_ht m_hs m_rw m_rt m_rs
global G_hw G_ht G_hs G_rw G_rt G_rs
global K_w K_t K_s K_tw K_tt K_ts g
global l_w_0 l_t_0 l_s_0

q_w=X(1); q_t=X(2);

j11 = K_tw + g*m_rs*(G_rs*((L_rw*sin(q_w)*sin(q_hh - (5*pi)/2))/sin(q_hh) + (L_rw*cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*sin(q_hk - q_hh + (3*pi)/2)*sin(q_w))/(sin(q_hh)*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(1/2)) + (L_rw^2*sin(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*sin(q_hk - q_hh + (3*pi)/2)*cos(q_w)^2*sin(q_hk))/(L_rs*sin(q_hh)^2*((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2 - 1)) - (L_rw^2*cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*sin(q_hk - q_hh + (3*pi)/2)*cos(q_w)^2*sin(q_hk)*(L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh)))/(L_rs^2*sin(q_hh)^2*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(3/2))) + (L_rw*sin(q_w)*sin(q_hh - (5*pi)/2))/sin(q_hh)) - G_rw*g*m_rw*(L_rw*sin(q_w + (3*pi)/2) + (2*L_rw*sin(q_hh + q_w))/sin(q_hh)) + (K_w*L_rw^2*cos(q_hh + q_w)^2)/sin(q_hh)^2 + (K_t*L_rw^2*cos(q_w)^2)/sin(q_hh)^2 - (K_w*L_rw*sin(q_hh + q_w)*(l_w_0 + (L_rw*sin(q_hh + q_w) - L_hw*sin(q_hh) + L_rtw*sin(q_t))/sin(q_hh)))/sin(q_hh) + (K_t*L_rw*sin(q_w)*(l_t_0 - (L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w))/sin(q_hh)))/sin(q_hh) - (K_s*L_rw^2*cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))^2*cos(q_w)^2)/(sin(q_hh)^2*((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2 - 1)) - (K_ts*L_rw^2*cos(q_w)^2*sin(q_hk)^2)/(L_rs^2*sin(q_hh)^2*((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2 - 1)) + (K_s*L_rw*cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*sin(q_w)*(l_s_0 + (L_rts*sin(q_t) - L_hs*sin(q_hk) + L_rs*sin(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)))/sin(q_hk)))/(sin(q_hh)*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(1/2)) + (G_ht*L_rw*g*m_ht*sin(q_w)*sin(q_hh - (5*pi)/2))/sin(q_hh) + (2*G_rt*L_rw*g*m_rt*sin(q_w)*sin(q_hh - (5*pi)/2))/sin(q_hh) - (K_ts*L_rw*asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)*sin(q_hk)*sin(q_w))/(L_rs*sin(q_hh)*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(1/2)) + (K_s*L_rw^2*sin(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*cos(q_w)^2*sin(q_hk)*(l_s_0 + (L_rts*sin(q_t) - L_hs*sin(q_hk) + L_rs*sin(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)))/sin(q_hk)))/(L_rs*sin(q_hh)^2*((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2 - 1)) + (K_ts*L_rw^2*asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)*cos(q_w)^2*sin(q_hk)^2*(L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh)))/(L_rs^3*sin(q_hh)^2*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(3/2)) - (K_s*L_rw^2*cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*cos(q_w)^2*sin(q_hk)*(l_s_0 + (L_rts*sin(q_t) - L_hs*sin(q_hk) + L_rs*sin(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)))/sin(q_hk))*(L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh)))/(L_rs^2*sin(q_hh)^2*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(3/2));

j12 = G_rs*g*m_rs*((L_rw*sin(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*sin(q_hk - q_hh + (3*pi)/2)*cos(q_w)*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh)))/(L_rs*sin(q_hh)*((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2 - 1)) - (L_rw*cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*sin(q_hk - q_hh + (3*pi)/2)*cos(q_w)*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh))*(L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh)))/(L_rs^2*sin(q_hh)*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(3/2))) + (K_t*L_rw*L_rtw*cos(q_hh + q_t)*cos(q_w))/sin(q_hh)^2 + (K_w*L_rw*L_rtw*cos(q_hh + q_w)*cos(q_t))/sin(q_hh)^2 - (K_ts*L_rw*cos(q_w)*sin(q_hk)*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh)))/(L_rs^2*sin(q_hh)*((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2 - 1)) - (K_s*L_rw*cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*cos(q_w)*(L_rts*cos(q_t) - (cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh)))/(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(1/2)))/(sin(q_hh)*sin(q_hk)*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(1/2)) + (K_s*L_rw*sin(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*cos(q_w)*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh))*(l_s_0 + (L_rts*sin(q_t) - L_hs*sin(q_hk) + L_rs*sin(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)))/sin(q_hk)))/(L_rs*sin(q_hh)*((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2 - 1)) - (K_s*L_rw*cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*cos(q_w)*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh))*(l_s_0 + (L_rts*sin(q_t) - L_hs*sin(q_hk) + L_rs*sin(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)))/sin(q_hk))*(L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh)))/(L_rs^2*sin(q_hh)*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(3/2)) + (K_ts*L_rw*asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)*cos(q_w)*sin(q_hk)*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh))*(L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh)))/(L_rs^3*sin(q_hh)*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(3/2));

j21 = (K_s*((L_rw*sin(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*cos(q_w)*sin(q_hk)*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh)))/(L_rs*sin(q_hh)*((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2 - 1)) - (L_rw*cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*cos(q_w)*sin(q_hk)*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh))*(L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh)))/(L_rs^2*sin(q_hh)*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(3/2)))*(l_s_0 + (L_rts*sin(q_t) - L_hs*sin(q_hk) + L_rs*sin(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)))/sin(q_hk)))/sin(q_hk) + (K_t*L_rw*L_rtw*cos(q_hh + q_t)*cos(q_w))/sin(q_hh)^2 + (K_w*L_rw*L_rtw*cos(q_hh + q_w)*cos(q_t))/sin(q_hh)^2 + (G_rs*g*m_rs*sin(q_hk - q_hh + (3*pi)/2)*((L_rw*sin(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*cos(q_w)*sin(q_hk)*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh)))/(L_rs*sin(q_hh)*((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2 - 1)) - (L_rw*cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*cos(q_w)*sin(q_hk)*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh))*(L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh)))/(L_rs^2*sin(q_hh)*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(3/2))))/sin(q_hk) - (K_ts*L_rw*cos(q_w)*sin(q_hk)*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh)))/(L_rs^2*sin(q_hh)*((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2 - 1)) - (K_s*L_rw*cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*cos(q_w)*(L_rts*cos(q_t) - (cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh)))/(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(1/2)))/(sin(q_hh)*sin(q_hk)*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(1/2)) + (K_ts*L_rw*asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)*cos(q_w)*sin(q_hk)*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh))*(L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh)))/(L_rs^3*sin(q_hh)*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(3/2));
 
j22 = K_tt + (K_s*(L_rts*cos(q_t) - (cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh)))/(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(1/2))^2)/sin(q_hk)^2 + g*m_rs*(L_rts*sin(q_hh + q_t - (5*pi)/2) + G_rs*(L_rts*sin(q_hh + q_t - (5*pi)/2) - (sin(q_hk - q_hh + (3*pi)/2)*(L_rts*sin(q_t) - (cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*(L_rts*sin(q_hk + q_t) + (L_rtw*sin(q_hh + q_t)*sin(q_hk))/sin(q_hh)))/(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(1/2) - (sin(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh))^2)/(L_rs*((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2 - 1)) + (cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh))^2*(L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh)))/(L_rs^2*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(3/2))))/sin(q_hk) + (L_rtw*sin(q_hh + q_t)*sin(q_hh - (5*pi)/2))/sin(q_hh)) + (L_rtw*sin(q_hh + q_t)*sin(q_hh - (5*pi)/2))/sin(q_hh)) - (K_ts*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh))^2)/(L_rs^2*((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2 - 1)) - (K_s*(l_s_0 + (L_rts*sin(q_t) - L_hs*sin(q_hk) + L_rs*sin(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)))/sin(q_hk))*(L_rts*sin(q_t) - (cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*(L_rts*sin(q_hk + q_t) + (L_rtw*sin(q_hh + q_t)*sin(q_hk))/sin(q_hh)))/(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(1/2) - (sin(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh))^2)/(L_rs*((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2 - 1)) + (cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh))^2*(L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh)))/(L_rs^2*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(3/2))))/sin(q_hk) + G_rt*g*m_rt*(L_rts*sin(q_hh + q_t - (5*pi)/2) + L_rtw*sin(q_hh + q_t - (3*pi)/2) + (2*L_rtw*sin(q_hh + q_t)*sin(q_hh - (5*pi)/2))/sin(q_hh)) + (K_t*L_rtw^2*cos(q_hh + q_t)^2)/sin(q_hh)^2 + (K_w*L_rtw^2*cos(q_t)^2)/sin(q_hh)^2 - (K_w*L_rtw*sin(q_t)*(l_w_0 + (L_rw*sin(q_hh + q_w) - L_hw*sin(q_hh) + L_rtw*sin(q_t))/sin(q_hh)))/sin(q_hh) - (K_ts*asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)*(L_rts*sin(q_hk + q_t) + (L_rtw*sin(q_hh + q_t)*sin(q_hk))/sin(q_hh)))/(L_rs*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(1/2)) + (K_t*L_rtw*sin(q_hh + q_t)*(l_t_0 - (L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w))/sin(q_hh)))/sin(q_hh) - (2*G_rw*L_rtw*g*m_rw*sin(q_t))/sin(q_hh) + (K_ts*asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh))^2*(L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh)))/(L_rs^3*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(3/2)) + (G_ht*L_rtw*g*m_ht*sin(q_hh + q_t)*sin(q_hh - (5*pi)/2))/sin(q_hh);

J = [j11 j12;
     j21 j22];
end